<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gloober - Travel Destination Finder</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Plane, Globe, MapPin, Star } = lucide;

        function SpinningGlobe({ isSpinning, onSpinComplete }) {
            const [rotation, setRotation] = useState(0);

            useEffect(() => {
                if (isSpinning) {
                    let currentRotation = 0;
                    const interval = setInterval(() => {
                        currentRotation += 15;
                        setRotation(currentRotation);
                        
                        if (currentRotation >= 540) {
                            clearInterval(interval);
                            setTimeout(() => {
                                onSpinComplete();
                            }, 500);
                        }
                    }, 50);

                    return () => clearInterval(interval);
                }
            }, [isSpinning, onSpinComplete]);

            return (
                <div className="relative w-80 h-80 mx-auto">
                    <div 
                        className="w-80 h-80 rounded-full bg-gradient-to-br from-blue-400 via-blue-500 to-blue-600 shadow-2xl relative overflow-hidden border-4 border-white/20"
                        style={{ 
                            transform: `rotate(${rotation}deg)`,
                            transition: isSpinning ? 'none' : 'transform 1s ease-out'
                        }}
                    >
                        {/* Europa */}
                        <div className="absolute top-20 left-24 w-8 h-6 bg-green-500 rounded-sm opacity-90 transform rotate-12"></div>
                        <div className="absolute top-24 left-28 w-4 h-3 bg-green-600 rounded-sm opacity-90"></div>
                        
                        {/* Africa */}
                        <div className="absolute top-28 left-20 w-12 h-20 bg-green-500 rounded-lg opacity-90 transform rotate-6"></div>
                        <div className="absolute top-32 left-22 w-8 h-12 bg-green-600 rounded-md opacity-85"></div>
                        
                        {/* Asia */}
                        <div className="absolute top-16 right-16 w-16 h-12 bg-green-500 rounded-lg opacity-90 transform -rotate-12"></div>
                        <div className="absolute top-18 right-12 w-10 h-8 bg-green-600 rounded-md opacity-85"></div>
                        <div className="absolute top-26 right-20 w-6 h-4 bg-green-700 rounded-sm opacity-80"></div>
                        
                        {/* Nord America */}
                        <div className="absolute top-12 left-8 w-14 h-16 bg-green-500 rounded-lg opacity-90 transform rotate-45"></div>
                        <div className="absolute top-16 left-6 w-8 h-10 bg-green-600 rounded-md opacity-85"></div>
                        
                        {/* Sud America */}
                        <div className="absolute bottom-16 left-12 w-8 h-20 bg-green-500 rounded-lg opacity-90 transform rotate-12"></div>
                        <div className="absolute bottom-20 left-14 w-5 h-12 bg-green-600 rounded-md opacity-85"></div>
                        
                        {/* Australia */}
                        <div className="absolute bottom-20 right-20 w-10 h-6 bg-green-500 rounded-lg opacity-90 transform -rotate-6"></div>
                        
                        {/* Nuvole/Riflessi */}
                        <div className="absolute top-8 left-8 w-12 h-12 bg-white opacity-15 rounded-full blur-sm"></div>
                        <div className="absolute top-32 right-12 w-8 h-8 bg-white opacity-10 rounded-full blur-sm"></div>
                        <div className="absolute bottom-24 left-16 w-10 h-10 bg-white opacity-12 rounded-full blur-sm"></div>
                        
                        {/* Linee geografiche */}
                        <div className="absolute inset-0">
                            <div className="absolute top-1/2 left-0 w-full h-0.5 bg-white/15"></div>
                            <div className="absolute left-1/2 top-0 w-0.5 h-full bg-white/15"></div>
                            <div className="absolute top-20 left-0 w-full h-0.5 bg-white/10 transform rotate-2"></div>
                            <div className="absolute bottom-20 left-0 w-full h-0.5 bg-white/10 transform -rotate-2"></div>
                        </div>
                        
                        {/* Texture oceano */}
                        <div className="absolute inset-0">
                            <div className="absolute top-10 left-10 w-2 h-2 bg-blue-300 rounded-full opacity-30 animate-pulse"></div>
                            <div className="absolute top-40 right-8 w-1 h-1 bg-blue-200 rounded-full opacity-40 animate-pulse" style={{animationDelay: '0.5s'}}></div>
                            <div className="absolute bottom-12 left-20 w-1.5 h-1.5 bg-blue-300 rounded-full opacity-35 animate-pulse" style={{animationDelay: '1s'}}></div>
                        </div>
                    </div>
                    
                    {!isSpinning && (
                        <div className="absolute top-20 right-16 animate-bounce">
                            <div className="w-6 h-6 bg-red-500 rounded-full border-2 border-white shadow-lg relative">
                                <div className="absolute -top-1 -left-1 w-2 h-2 bg-red-400 rounded-full animate-ping"></div>
                            </div>
                            <div className="w-1 h-4 bg-red-500 mx-auto"></div>
                        </div>
                    )}
                </div>
            );
        }

        function BudgetGlobeApp() {
            const [step, setStep] = useState(1);
            const [language, setLanguage] = useState('it');
            const [formData, setFormData] = useState({
                budget: 800,
                luxuryLevel: 40,
                when: 'flexible',
                people: 2,
                preferences: [],
                dateFrom: '',
                dateTo: ''
            });
            const [isSpinning, setIsSpinning] = useState(false);
            const [result, setResult] = useState(null);

            const translations = {
                it: {
                    title: "Gloober",
                    subtitle: "Gloob your next destination! üåç",
                    configure: "Configura la tua avventura",
                    budget: "üí∞ Budget totale (‚Ç¨)",
                    people: "üë• Quante persone?",
                    style: "‚ú® Stile di viaggio",
                    when: "üìÖ Quando?",
                    preferences: "üéØ Preferenze",
                    action: "JUST GLOOB IT!",
                    minBudget: "Budget minimo: ‚Ç¨200",
                    gloobbing: "üåç Gloobbing...",
                    searching: "Cercando la destinazione per {people} persone con budget ‚Ç¨{budget}!",
                    result: "üéâ La tua destinazione!",
                    regloob: "üé≤ Regloob",
                    book: "‚úàÔ∏è PRENOTA!"
                },
                en: {
                    title: "Gloober", 
                    subtitle: "Gloob your next destination! üåç",
                    configure: "Configure your adventure",
                    budget: "üí∞ Total budget (‚Ç¨)",
                    people: "üë• How many people?",
                    style: "‚ú® Travel style", 
                    when: "üìÖ When?",
                    preferences: "üéØ Preferences",
                    action: "JUST GLOOB IT!",
                    minBudget: "Minimum budget: ‚Ç¨200",
                    gloobbing: "üåç Gloobbing...",
                    searching: "Finding destination for {people} people with ‚Ç¨{budget} budget!",
                    result: "üéâ Your destination!",
                    regloob: "üé≤ Regloob",
                    book: "‚úàÔ∏è BOOK NOW!"
                },
                es: {
                    title: "Gloober",
                    subtitle: "¬°Gloobea tu pr√≥ximo destino! üåç", 
                    configure: "Configura tu aventura",
                    budget: "üí∞ Presupuesto total (‚Ç¨)",
                    people: "üë• ¬øCu√°ntas personas?",
                    style: "‚ú® Estilo de viaje",
                    when: "üìÖ ¬øCu√°ndo?", 
                    preferences: "üéØ Preferencias",
                    action: "¬°JUST GLOOB IT!",
                    minBudget: "Presupuesto m√≠nimo: ‚Ç¨200",
                    gloobbing: "üåç Gloobeando...",
                    searching: "¬°Buscando destino para {people} personas con ‚Ç¨{budget}!",
                    result: "üéâ ¬°Tu destino!",
                    regloob: "üé≤ Regloobear",
                    book: "‚úàÔ∏è ¬°RESERVAR!"
                },
                fr: {
                    title: "Gloober",
                    subtitle: "Gloobe ta prochaine destination! üåç",
                    configure: "Configure ton aventure", 
                    budget: "üí∞ Budget total (‚Ç¨)",
                    people: "üë• Combien de personnes?",
                    style: "‚ú® Style de voyage",
                    when: "üìÖ Quand?",
                    preferences: "üéØ Pr√©f√©rences", 
                    action: "JUST GLOOB IT!",
                    minBudget: "Budget minimum: ‚Ç¨200",
                    gloobbing: "üåç Gloobbing...",
                    searching: "Recherche destination pour {people} personnes avec ‚Ç¨{budget}!",
                    result: "üéâ Ta destination!",
                    regloob: "üé≤ Regloober",
                    book: "‚úàÔ∏è R√âSERVER!"
                }
            };

            const t = translations[language];

            const preferences = [
                { id: 'sea', label: { it: 'üèñÔ∏è Mare', en: 'üèñÔ∏è Sea', es: 'üèñÔ∏è Mar', fr: 'üèñÔ∏è Mer' } },
                { id: 'mountain', label: { it: 'üèîÔ∏è Montagna', en: 'üèîÔ∏è Mountain', es: 'üèîÔ∏è Monta√±a', fr: 'üèîÔ∏è Montagne' } },
                { id: 'art', label: { it: 'üé® Arte', en: 'üé® Art', es: 'üé® Arte', fr: 'üé® Art' } },
                { id: 'romantic', label: { it: 'üíï Romantico', en: 'üíï Romantic', es: 'üíï Rom√°ntico', fr: 'üíï Romantique' } },
                { id: 'adventure', label: { it: 'üéí Avventura', en: 'üéí Adventure', es: 'üéí Aventura', fr: 'üéí Aventure' } },
                { id: 'food', label: { it: 'üçù Food', en: 'üçù Food', es: 'üçù Comida', fr: 'üçù Cuisine' } },
                { id: 'nightlife', label: { it: 'üåÉ Vita Notturna', en: 'üåÉ Nightlife', es: 'üåÉ Vida Nocturna', fr: 'üåÉ Vie Nocturne' } },
                { id: 'culture', label: { it: 'üèõÔ∏è Cultura', en: 'üèõÔ∏è Culture', es: 'üèõÔ∏è Cultura', fr: 'üèõÔ∏è Culture' } }
            ];

            const destinations = {
                cheap: [
                    { 
                        name: 'Praga', country: 'Repubblica Ceca', price: 300, image: 'üç∫', 
                        description: 'Castello e birra artigianale', days: 4, 
                        tags: ['art', 'food', 'culture', 'nightlife'], 
                        hotel: { name: 'Hostel One Home', stars: 2, amenities: ['Design Moderno', 'Pub Crawl', 'Centro Storico'], rating: 9.4 }, 
                        flights: { departure: '14:20', arrival: '16:05', return_departure: '17:30', return_arrival: '19:15', airline: 'Czech Airlines', duration: '1h 45m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Praga (PRG)' }, 
                        quote: { text: "Praga non ti lascia andare. Questa piccola madre ha gli artigli.", author: "Franz Kafka" }, 
                        tip: "Bevi birra nei pub sotterranei medievali: la Pilsner √® nata qui nel 1842!" 
                    },
                    
                    { 
                        name: 'Split', country: 'Croazia', price: 280, image: 'üèñÔ∏è', 
                        description: 'Palazzo di Diocleziano e spiagge cristalline', days: 4, 
                        tags: ['sea', 'culture', 'adventure'], 
                        hotel: { name: 'Villa Dalmacija', stars: 3, amenities: ['Vista Mare', 'Centro Storico', 'Spiaggia 2min'], rating: 9.0 }, 
                        flights: { departure: '13:45', arrival: '15:20', return_departure: '16:00', return_arrival: '17:35', airline: 'Croatia Airlines', duration: '1h 35m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Split (SPU)' }, 
                        quote: { text: "Il mare, una volta lanciato il suo incantesimo, ti tiene per sempre nella sua rete di meraviglia.", author: "Jacques Cousteau" }, 
                        tip: "Dormi nel Palazzo di Diocleziano: l'unico posto al mondo dove vivi in un palazzo romano!" 
                    },

                    { 
                        name: 'Sofia', country: 'Bulgaria', price: 250, image: '‚õ™', 
                        description: 'Chiese ortodosse e montagne', days: 4, 
                        tags: ['culture', 'mountain', 'art'], 
                        hotel: { name: 'Art Hostel Sofia', stars: 2, amenities: ['Gallery Hotel', 'Vista Vitosha', 'Breakfast Locale'], rating: 9.2 }, 
                        flights: { departure: '16:30', arrival: '19:45', return_departure: '14:20', return_arrival: '15:35', airline: 'Bulgaria Air', duration: '2h 15m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Sofia (SOF)' }, 
                        quote: { text: "Le montagne sono le cattedrali della terra.", author: "John Ruskin" }, 
                        tip: "Visita il monastero di Rila: patrimonio UNESCO a 2 ore da Sofia, immerso nelle montagne." 
                    },
                    
                    { 
                        name: 'Cracovia', country: 'Polonia', price: 290, image: 'üèõÔ∏è', 
                        description: 'Centro medievale UNESCO', days: 4, 
                        tags: ['art', 'culture', 'romantic'], 
                        hotel: { name: 'Poco Loco Hostel', stars: 2, amenities: ['Centro UNESCO', 'Rooftop Bar', 'Tour Gratuiti'], rating: 9.5 }, 
                        flights: { departure: '06:45', arrival: '08:35', return_departure: '19:20', return_arrival: '21:10', airline: 'LOT Polish', duration: '1h 50m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Cracovia (KRK)' }, 
                        quote: { text: "Cracovia √® un libro di pietra che racconta mille anni di storia.", author: "Papa Giovanni Paolo II" }, 
                        tip: "Prenota il tour delle miniere di sale Wieliczka: cattedrale sotterranea scavata nel sale!" 
                    },
                    
                    { 
                        name: 'Lisbona', country: 'Portogallo', price: 320, image: 'üöã', 
                        description: 'Tram storici e past√©is de nata', days: 4, 
                        tags: ['sea', 'culture', 'food', 'romantic'], 
                        hotel: { name: 'Casa do Bacalhau', stars: 3, amenities: ['Palazzo Storico', 'Azulejos', 'Past√©is Gratis'], rating: 9.1 }, 
                        flights: { departure: '11:15', arrival: '13:40', return_departure: '14:30', return_arrival: '18:55', airline: 'TAP Air Portugal', duration: '2h 25m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Lisbona (LIS)' }, 
                        quote: { text: "Lisbona ha quel non so che che la rende unica al mondo.", author: "Fernando Pessoa" }, 
                        tip: "Prendi il tram 28 al tramonto: attraversa tutta la citt√† per soli ‚Ç¨3!" 
                    },
                    
                    { 
                        name: 'Palma', country: 'Spagna', price: 320, image: 'üèñÔ∏è', 
                        description: 'Spiagge e vita notturna', days: 4, 
                        tags: ['sea', 'nightlife', 'adventure'], 
                        hotel: { name: 'Toc Hostel & Suites', stars: 3, amenities: ['Beach 5min', 'Rooftop Pool', 'Bike Rental'], rating: 8.9 }, 
                        flights: { departure: '10:15', arrival: '12:30', return_departure: '13:20', return_arrival: '15:35', airline: 'Vueling', duration: '2h 15m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Palma di Maiorca (PMI)' }, 
                        quote: { text: "Il Mediterraneo √® il mare dei mari.", author: "Fernand Braudel" }, 
                        tip: "Scopri le spiagge nascoste di Formentor: il paradiso segreto dei locali!" 
                    },
                    
                    { 
                        name: 'Valencia', country: 'Spagna', price: 340, image: 'ü•ò', 
                        description: 'Paella originale e Citt√† delle Arti', days: 4, 
                        tags: ['sea', 'food', 'art', 'culture'], 
                        hotel: { name: 'Purple Nest Hostel', stars: 3, amenities: ['Design Awards', 'Beach Shuttle', 'Paella Classes'], rating: 9.0 }, 
                        flights: { departure: '09:25', arrival: '11:40', return_departure: '18:15', return_arrival: '20:30', airline: 'Iberia', duration: '2h 15m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Valencia (VLC)' }, 
                        quote: { text: "Valencia √® il giardino di Spagna.", author: "Vicente Blasco Ib√°√±ez" }, 
                        tip: "Mangia paella solo a pranzo (mai a cena): √® la regola d'oro valenciana!" 
                    },
                    
                    { 
                        name: 'Nizza', country: 'Francia', price: 350, image: 'üå¥', 
                        description: 'Costa Azzurra e spiagge chic', days: 4, 
                        tags: ['sea', 'romantic', 'culture'], 
                        hotel: { name: 'Hotel Villa Victoria', stars: 3, amenities: ['Centro Storico', 'Vicino Mare', 'Terrazza'], rating: 8.8 }, 
                        flights: { departure: '12:40', arrival: '14:15', return_departure: '15:20', return_arrival: '16:55', airline: 'easyJet', duration: '1h 35m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Nizza (NCE)' }, 
                        quote: { text: "Nizza √® dove l'azzurro del mare incontra l'azzurro del cielo.", author: "Matisse" }, 
                        tip: "Passeggia sulla Promenade des Anglais al tramonto: 7km di pura magia!" 
                    }
                ],
                
                mid: [
                    { 
                        name: 'Barcellona', country: 'Spagna', price: 480, image: 'üèñÔ∏è', 
                        description: 'Gaud√≠, tapas e Mare Mediterraneo', days: 4, 
                        tags: ['sea', 'art', 'food', 'nightlife'], 
                        hotel: { name: 'Hotel Casa Fuster', stars: 4, amenities: ['Palazzo Modernista', 'Rooftop Bar', 'Centro'], rating: 8.8 }, 
                        flights: { departure: '11:30', arrival: '13:45', return_departure: '18:15', return_arrival: '20:30', airline: 'Vueling', duration: '2h 15m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Barcellona (BCN)' }, 
                        quote: { text: "Barcellona √® una citt√† che non dorme mai.", author: "Salvador Dal√≠" }, 
                        tip: "Visita Park G√ºell al tramonto: la vista sulla citt√† √® magica!" 
                    },
                    { 
                        name: 'Vienna', country: 'Austria', price: 580, image: 'üéº', 
                        description: 'Musica classica e caff√® imperiali', days: 4, 
                        tags: ['art', 'culture', 'romantic', 'food'], 
                        hotel: { name: 'Hotel Am Ring', stars: 4, amenities: ['Centro Storico', 'Caffetteria', 'Opera Vicina'], rating: 8.7 }, 
                        flights: { departure: '12:20', arrival: '14:05', return_departure: '16:40', return_arrival: '18:25', airline: 'Austrian Airlines', duration: '1h 45m', stops: 'Diretto', from: 'Milano Malpensa (MXP)', to: 'Vienna (VIE)' }, 
                        quote: { text: "Vienna √® la citt√† dei sogni.", author: "Sigmund Freud" }, 
                        tip: "Prova la Sachertorte originale al Caf√© Sacher: ricetta segreta dal 1832!" 
                    }
                ],

                luxury: [
                    { 
                        name: 'Santorini', country: 'Grecia', price: 1200, image: 'üåÖ', 
                        description: 'Tramonto cicladico e resort esclusivi', days: 3, 
                        tags: ['sea', 'romantic'], 
                        hotel: { name: 'Grace Hotel Santorini', stars: 5, amenities: ['Infinity Pool', 'Vista Caldera', 'Butler Service'], rating: 9.6 }, 
                        flights: { departure: '09:15', arrival: '13:40', return_departure: '15:50', return_arrival: '18:15', airline: 'Aegean Airlines', duration: '3h 25m', stops: '1 Stop Atene', from: 'Milano Malpensa (MXP)', to: 'Santorini (JTR)' }, 
                        quote: { text: "Santorini √® dove il cielo incontra il mare.", author: "Homer" }, 
                        tip: "Prenota una cena al tramonto a Oia: il momento pi√π romantico dell'isola!" 
                    }
                ]
            };

            const handleSpin = () => {
                if (formData.budget < 200) {
                    alert('Budget minimo: ‚Ç¨200');
                    return;
                }
                setIsSpinning(true);
                setStep(2);
            };

            const onSpinComplete = () => {
                setTimeout(() => {
                    let category = 'cheap';
                    if (formData.luxuryLevel >= 35 && formData.luxuryLevel < 70) category = 'mid';
                    else if (formData.luxuryLevel >= 70) category = 'luxury';
                    
                    let validDestinations = destinations[category].filter(d => 
                        d.price <= (formData.budget / formData.people)
                    );
                    
                    if (formData.preferences.length > 0) {
                        const perfectMatch = validDestinations.filter(destination => {
                            return formData.preferences.every(pref => 
                                destination.tags && destination.tags.includes(pref)
                            );
                        });
                        
                        if (perfectMatch.length > 0) {
                            validDestinations = perfectMatch;
                        } else {
                            const partialMatch = validDestinations.filter(destination => {
                                return formData.preferences.some(pref => 
                                    destination.tags && destination.tags.includes(pref)
                                );
                            });
                            
                            if (partialMatch.length > 0) {
                                validDestinations = partialMatch;
                            } else {
                                if (formData.preferences.includes('sea')) {
                                    const allSeaDestinations = [];
                                    Object.values(destinations).forEach(categoryDests => {
                                        categoryDests.forEach(dest => {
                                            if (dest.tags && dest.tags.includes('sea') && dest.price <= (formData.budget / formData.people)) {
                                                allSeaDestinations.push(dest);
                                            }
                                        });
                                    });
                                    if (allSeaDestinations.length > 0) {
                                        validDestinations = allSeaDestinations;
                                    }
                                }
                            }
                        }
                    }
                    
                    const randomDest = validDestinations.length > 0 
                        ? validDestinations[Math.floor(Math.random() * validDestinations.length)]
                        : destinations.cheap[Math.floor(Math.random() * destinations.cheap.length)];
                    
                    const startDate = new Date();
                    if (formData.when === 'custom' && formData.dateFrom) {
                        startDate.setTime(new Date(formData.dateFrom).getTime());
                    } else if (formData.when === 'weekend') {
                        const daysToFriday = (5 - startDate.getDay() + 7) % 7;
                        if (daysToFriday === 0 && startDate.getDay() !== 5) {
                            startDate.setDate(startDate.getDate() + 7);
                        } else {
                            startDate.setDate(startDate.getDate() + daysToFriday);
                        }
                    } else if (formData.when === 'week') {
                        startDate.setDate(startDate.getDate() + 7);
                    } else if (formData.when === 'month') {
                        startDate.setMonth(startDate.getMonth() + 1);
                    } else {
                        startDate.setDate(startDate.getDate() + Math.floor(Math.random() * 30) + 1);
                    }
                    
                    const endDate = new Date(startDate);
                    if (formData.when === 'custom' && formData.dateTo) {
                        endDate.setTime(new Date(formData.dateTo).getTime());
                    } else if (formData.when === 'weekend') {
                        endDate.setDate(endDate.getDate() + 2);
                    } else if (formData.when === 'week') {
                        endDate.setDate(endDate.getDate() + 6);
                    } else if (formData.when === 'month') {
                        endDate.setDate(endDate.getDate() + 29);
                    } else {
                        endDate.setDate(endDate.getDate() + randomDest.days - 1);
                    }
                    
                    setResult({
                        ...randomDest,
                        startDate,
                        endDate,
                        totalPrice: randomDest.price * formData.people,
                        pricePerPerson: randomDest.price
                    });
                    setIsSpinning(false);
                    setStep(3);
                }, 1000);
            };

            const togglePreference = (pref) => {
                setFormData(prev => ({
                    ...prev,
                    preferences: prev.preferences.includes(pref)
                        ? prev.preferences.filter(p => p !== pref)
                        : [...prev.preferences, pref]
                }));
            };

            if (step === 1) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-teal-900 via-green-900 to-emerald-900 text-white">
                        <div className="container mx-auto px-4 py-8">
                            <div className="text-center mb-8
<div className="text-center mb-8">
                                <div className="flex justify-end mb-4">
                                    <select 
                                        value={language} 
                                        onChange={(e) => setLanguage(e.target.value)}
                                        className="bg-white/10 text-white border border-white/20 rounded-lg px-3 py-1 text-sm"
                                    >
                                        <option value="it" className="text-gray-800">üáÆüáπ Italiano</option>
                                        <option value="en" className="text-gray-800">üá¨üáß English</option>
                                        <option value="es" className="text-gray-800">üá™üá∏ Espa√±ol</option>
                                        <option value="fr" className="text-gray-800">üá´üá∑ Fran√ßais</option>
                                    </select>
                                </div>
                                <h1 className="text-6xl font-bold mb-4 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                                    {t.title}
                                </h1>
                                <p className="text-xl text-gray-300">
                                    {t.subtitle}
                                </p>
                            </div>

                            <div className="grid lg:grid-cols-2 gap-12 items-center max-w-6xl mx-auto">
                                <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 border border-white/20">
                                    <h2 className="text-2xl font-bold mb-6">{t.configure}</h2>
                                    
                                    <div className="mb-6">
                                        <label className="block text-sm font-medium mb-2">{t.budget}</label>
                                        <input
                                            type="number"
                                            value={formData.budget === 0 ? '' : formData.budget}
                                            onChange={(e) => setFormData(prev => ({...prev, budget: e.target.value === '' ? 0 : parseInt(e.target.value) || 0}))}
                                            className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white text-xl font-bold focus:ring-2 focus:ring-yellow-400 outline-none"
                                            min="200"
                                            max="5000"
                                            step="50"
                                            placeholder="Inserisci budget (es. 800)"
                                        />
                                    </div>

                                    <div className="mb-6">
                                        <label className="block text-sm font-medium mb-2">{t.people}</label>
                                        <select
                                            value={formData.people}
                                            onChange={(e) => setFormData(prev => ({...prev, people: parseInt(e.target.value)}))}
                                            className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-yellow-400 outline-none"
                                        >
                                            <option value={1} className="text-gray-800">1 persona</option>
                                            <option value={2} className="text-gray-800">2 persone</option>
                                            <option value={3} className="text-gray-800">3 persone</option>
                                            <option value={4} className="text-gray-800">4 persone</option>
                                        </select>
                                    </div>

                                    <div className="mb-6">
                                        <label className="block text-sm font-medium mb-2">{t.style}</label>
                                        <input
                                            type="range"
                                            value={formData.luxuryLevel}
                                            onChange={(e) => setFormData(prev => ({...prev, luxuryLevel: parseInt(e.target.value)}))}
                                            className="w-full h-3 bg-gradient-to-r from-green-500 via-yellow-500 to-purple-500 rounded-lg appearance-none cursor-pointer"
                                            min="0"
                                            max="100"
                                        />
                                        <div className="flex justify-between text-xs mt-2">
                                            <span className="text-green-400 font-bold">CHEAP</span>
                                            <span className="text-yellow-400 font-bold">MID</span>
                                            <span className="text-purple-400 font-bold">LUXURY</span>
                                        </div>
                                    </div>

                                    <div className="mb-6">
                                        <label className="block text-sm font-medium mb-2">{t.when}</label>
                                        <select
                                            value={formData.when}
                                            onChange={(e) => setFormData(prev => ({...prev, when: e.target.value}))}
                                            className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-yellow-400 outline-none mb-3"
                                        >
                                            <option value="flexible" className="text-gray-800">üé≤ Flessibile (sorprendimi!)</option>
                                            <option value="weekend" className="text-gray-800">üìÖ Viaggio di un weekend</option>
                                            <option value="week" className="text-gray-800">üìÖ Viaggio di una settimana</option>
                                            <option value="month" className="text-gray-800">üìÖ Viaggio di un mese</option>
                                            <option value="custom" className="text-gray-800">üìÖ Scegli date specifiche</option>
                                        </select>
                                        
                                        {formData.when === 'custom' && (
                                            <div className="grid grid-cols-2 gap-3">
                                                <div>
                                                    <label className="block text-xs text-gray-400 mb-1">Dal</label>
                                                    <input
                                                        type="date"
                                                        value={formData.dateFrom}
                                                        onChange={(e) => setFormData(prev => ({...prev, dateFrom: e.target.value}))}
                                                        className="w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-yellow-400 outline-none"
                                                        min={new Date().toISOString().split('T')[0]}
                                                    />
                                                </div>
                                                <div>
                                                    <label className="block text-xs text-gray-400 mb-1">Al</label>
                                                    <input
                                                        type="date"
                                                        value={formData.dateTo}
                                                        onChange={(e) => setFormData(prev => ({...prev, dateTo: e.target.value}))}
                                                        className="w-full px-3 py-2 rounded-lg bg-white/10 border border-white/20 text-white focus:ring-2 focus:ring-yellow-400 outline-none"
                                                        min={formData.dateFrom || new Date().toISOString().split('T')[0]}
                                                    />
                                                </div>
                                            </div>
                                        )}
                                    </div>

                                    <div className="mb-8">
                                        <label className="block text-sm font-medium mb-3">{t.preferences}</label>
                                        <div className="grid grid-cols-2 gap-2">
                                            {preferences.map(pref => (
                                                <button
                                                    key={pref.id}
                                                    onClick={() => togglePreference(pref.id)}
                                                    className={`p-3 rounded-xl text-sm font-medium transition-all ${
                                                        formData.preferences.includes(pref.id)
                                                            ? 'bg-yellow-500 text-black'
                                                            : 'bg-white/10 hover:bg-white/20'
                                                    }`}
                                                >
                                                    {pref.label[language]}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    <button
                                        onClick={handleSpin}
                                        className="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-bold py-4 px-8 rounded-xl text-xl hover:from-yellow-300 hover:to-orange-400 transition-all flex items-center justify-center gap-3"
                                        disabled={formData.budget < 200}
                                    >
                                        <Globe />
                                        {formData.budget >= 200 ? t.action : t.minBudget}
                                    </button>
                                </div>

                                <div className="flex items-center justify-center">
                                    <SpinningGlobe isSpinning={false} onSpinComplete={() => {}} />
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (step === 2) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-teal-900 via-green-900 to-emerald-900 text-white flex items-center justify-center">
                        <div className="text-center">
                            <SpinningGlobe isSpinning={isSpinning} onSpinComplete={onSpinComplete} />
                            <h2 className="text-4xl font-bold mb-4 mt-8">{t.gloobbing}</h2>
                            <p className="text-xl text-gray-300">
                                {t.searching.replace('{people}', formData.people).replace('{budget}', formData.budget)}
                            </p>
                        </div>
                    </div>
                );
            }

            if (step === 3 && result) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-teal-900 via-green-900 to-emerald-900 text-white">
                        <div className="container mx-auto px-4 py-8">
                            <div className="max-w-4xl mx-auto">
                                <div className="text-center mb-8">
                                    <h1 className="text-5xl font-bold mb-4">{t.result}</h1>
                                </div>

                                <div className="bg-white/10 backdrop-blur-lg rounded-3xl p-8 border border-white/20 mb-8">
                                    <div className="text-center mb-6">
                                        <div className="text-8xl mb-4">{result.image}</div>
                                        <h2 className="text-4xl font-bold text-yellow-400">{result.name}</h2>
                                        <p className="text-2xl text-gray-300">{result.country}</p>
                                        <p className="text-lg text-gray-400 mt-2">{result.description}</p>
                                        
                                        {formData.preferences.length > 0 && (
                                            <div className="mt-4 p-3 bg-teal-600/20 rounded-lg border border-teal-400/30">
                                                <p className="text-sm text-teal-200">
                                                    üîç Preferenze selezionate: <span className="font-bold text-white">{formData.preferences.map(p => preferences.find(pref => pref.id === p)?.label[language]).join(', ')}</span>
                                                </p>
                                                <p className="text-sm text-teal-200">
                                                    ‚úÖ Questa destinazione ha: <span className="font-bold text-white">{result.tags?.map(tag => preferences.find(p => p.id === tag)?.label[language] || tag).join(', ')}</span>
                                                </p>
                                                {formData.preferences.some(pref => !result.tags?.includes(pref)) && (
                                                    <p className="text-sm text-yellow-300 mt-1">
                                                        ‚ö†Ô∏è Alcune preferenze non combaciano perfettamente - hai selezionato pi√π filtri di quelli disponibili per questa destinazione
                                                    </p>
                                                )}
                                            </div>
                                        )}
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-6 mb-6">
                                        <div className="bg-white/90 backdrop-blur-lg rounded-2xl p-6 border border-white/20 shadow-lg">
                                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-gray-800">
                                                <Plane className="text-green-600" />
                                                ‚úàÔ∏è Dettagli Volo
                                            </h3>
                                            <div className="space-y-3">
                                                <div className="flex justify-between">
                                                    <span className="text-gray-600 font-medium">Compagnia:</span>
                                                    <span className="font-bold text-gray-900">{result.flights.airline}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-gray-600 font-medium">Da:</span>
                                                    <span className="font-bold text-gray-900">{result.flights.from}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-gray-600 font-medium">A:</span>
                                                    <span className="font-bold text-gray-900">{result.flights.to}</span>
                                                </div>
                                                <div className="bg-gray-50 rounded-lg p-3 mt-4">
                                                    <p className="text-xs text-gray-500 mb-2">ANDATA</p>
                                                    <div className="flex justify-between">
                                                        <span className="text-gray-600">Partenza:</span>
                                                        <span className="font-bold text-gray-900">{result.flights.departure}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-gray-600">Arrivo:</span>
                                                        <span className="font-bold text-gray-900">{result.flights.arrival}</span>
                                                    </div>
                                                </div>
                                                <div className="bg-gray-50 rounded-lg p-3">
                                                    <p className="text-xs text-gray-500 mb-2">RITORNO</p>
                                                    <div className="flex justify-between">
                                                        <span className="text-gray-600">Partenza:</span>
                                                        <span className="font-bold text-gray-900">{result.flights.return_departure}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-gray-600">Arrivo:</span>
                                                        <span className="font-bold text-gray-900">{result.flights.return_arrival}</span>
                                                    </div>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-gray-600 font-medium">Durata:</span>
                                                    <span className="font-bold text-gray-900">{result.flights.duration}</span>
                                                </div>
                                                <div className="flex justify-between">
                                                    <span className="text-gray-600 font-medium">Scali:</span>
                                                    <span className="font-bold text-gray-900">{result.flights.stops}</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div className="bg-white/90 backdrop-blur-lg rounded-2xl p-6 border border-white/20 shadow-lg">
                                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-gray-800">
                                                <MapPin className="text-blue-600" />
                                                üè® Hotel
                                            </h3>
                                            <div className="space-y-3">
                                                <div>
                                                    <h4 className="font-bold text-lg text-gray-900">{result.hotel.name}</h4>
                                                    <div className="flex items-center gap-1 mt-1">
                                                        {[...Array(result.hotel.stars)].map((_, i) => (
                                                            <Star key={i} size={16} className="text-yellow-500 fill-current" />
                                                        ))}
                                                        <span className="ml-2 text-sm bg-green-500 text-white px-2 py-1 rounded">
                                                            {result.hotel.rating}/10
                                                        </span>
                                                    </div>
                                                </div>
                                                <div className="space-y-2">
                                                    <p className="text-sm font-medium text-gray-600">Servizi inclusi:</p>
                                                    {result.hotel.amenities.map((amenity, i) => (
                                                        <div key={i} className="flex items-center gap-2 text-sm text-gray-900">
                                                            <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                                                            {amenity}
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-6 mb-6">
                                        <div className="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200 shadow-lg">
                                            <h3 className="text-lg font-bold mb-3 text-amber-800">üí≠ Ispirazione</h3>
                                            <blockquote className="italic text-gray-700 text-center mb-3">
                                                "{result.quote?.text}"
                                            </blockquote>
                                            <p className="text-sm text-amber-700 text-center font-medium">‚Äî {result.quote?.author}</p>
                                        </div>
                                        
                                        <div className="bg-gradient-to-br from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-200 shadow-lg">
                                            <h3 className="text-lg font-bold mb-3 text-emerald-800">üíé Travel Tip</h3>
                                            <p className="text-gray-700 text-sm leading-relaxed">
                                                {result.tip}
                                            </p>
                                        </div>
                                    </div>

                                    <div className="text-center">
                                        <p className="text-3xl font-bold text-yellow-400 mb-2">
                                            ‚Ç¨{result.totalPrice} totale
                                        </p>
                                        <p className="text-lg text-gray-300 mb-4">
                                            ‚Ç¨{result.pricePerPerson} per persona
                                        </p>
                                        
                                        <div className="bg-teal-600/20 rounded-lg p-4 border border-teal-400/30">
                                            <h3 className="text-lg font-bold text-teal-200 mb-2">üìÖ Date del viaggio</h3>
                                            <div className="grid grid-cols-2 gap-4 text-sm">
                                                <div>
                                                    <span className="text-teal-300">Partenza:</span>
                                                    <div className="font-bold text-white">
                                                        {result.startDate.toLocaleDateString('it-IT', { 
                                                            weekday: 'long', 
                                                            year: 'numeric', 
                                                            month: 'long', 
                                                            day: 'numeric' 
                                                        })}
                                                    </div>
                                                </div>
                                                <div>
                                                    <span className="text-teal-300">Ritorno:</span>
                                                    <div className="font-bold text-white">
                                                        {result.endDate.toLocaleDateString('it-IT', { 
                                                            weekday: 'long', 
                                                            year: 'numeric', 
                                                            month: 'long', 
                                                            day: 'numeric' 
                                                        })}
                                                    </div>
                                                </div>
                                            </div>
                                            <p className="text-xs text-teal-200 mt-2">
                                                Durata: {Math.ceil((result.endDate - result.startDate) / (1000 * 60 * 60 * 24))} giorni
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div className="text-center">
                                    <button 
                                        onClick={() => window.open(`https://booking.com/searchresults.html?ss=${encodeURIComponent(result.name)}&checkin=${result.startDate.toISOString().split('T')[0]}&checkout=${result.endDate.toISOString().split('T')[0]}&group_adults=${formData.people}`, '_blank')}
                                        className="bg-green-500 text-white font-bold py-4 px-12 rounded-xl text-xl mr-4 hover:bg-green-600 transition-colors"
                                    >
                                        {t.book}
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setStep(1); 
                                            setResult(null); 
                                            setIsSpinning(false);
                                        }}
                                        className="bg-gray-600 text-white font-bold py-4 px-8 rounded-xl text-xl hover:bg-gray-700 transition-colors"
                                    >
                                        {t.regloob}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return null;
        }

        ReactDOM.render(<BudgetGlobeApp />, document.getElementById('root'));
    </script>
</body>
</html>
