<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gloober - Zero Stress Travel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0f766e, #065f46, #064e3b);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Nuovo slider orizzontale */
        .vibes-slider-horizontal {
            position: relative;
            width: 100%;
            height: 60px;
            margin: 20px auto 20px;
            border-radius: 30px;
            background: linear-gradient(to right, #fbbf24 0%, #f59e0b 50%, #fbbf24 100%);
            cursor: pointer;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        /* Etichette dentro lo slider */
        .slider-inner-labels {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            pointer-events: none;
        }
        
        .slider-inner-labels span {
            color: rgba(0, 0, 0, 0.5);
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(255,255,255,0.3);
        }
        
        .slider-inner-labels .label-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            transition: opacity 0.3s ease;
        }
        
        .slider-inner-labels .label-center.hidden {
            opacity: 0;
        }
        
        .vibes-dot {
            position: absolute;
            width: 56px;
            height: 56px;
            background: radial-gradient(circle at 30% 30%, #60a5fa, #3b82f6, #2563eb, #1e40af);
            border: 3px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            cursor: grab;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: inset -10px -10px 20px rgba(0, 0, 0, 0.4), 0 4px 16px rgba(0, 0, 0, 0.3);
            transition: left 0.3s ease, transform 0.2s ease;
            position: relative;
        }
        
        .vibes-dot.dragging {
            cursor: grabbing;
        }
        
        .vibes-dot.clickable {
            transform: translateX(-50%) scale(1.05);
            cursor: pointer;
        }
        
        .vibes-dot.clickable:hover {
            transform: translateX(-50%) scale(1.1);
        }
        
        /* Mini continenti nel globo */
        .vibes-dot::before {
            content: '';
            position: absolute;
            background: radial-gradient(ellipse, #10b981, #059669);
            width: 12px;
            height: 10px;
            top: 25%;
            left: 50%;
            border-radius: 50%;
            transform: translateX(-50%);
        }
        
        .vibes-dot::after {
            content: '';
            position: absolute;
            background: radial-gradient(ellipse, #10b981, #059669);
            width: 15px;
            height: 8px;
            bottom: 30%;
            left: 45%;
            border-radius: 50%;
            transform: translateX(-50%);
        }
        
        /* Testo JUST GLOOB IT sotto il globo */
        .gloob-text {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            white-space: nowrap;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            background: rgba(0, 0, 0, 0.3);
            padding: 4px 12px;
            border-radius: 20px;
        }
        
        .vibes-dot.clickable .gloob-text {
            opacity: 1;
        }
        
        .vibes-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding: 0 10px;
            position: relative;
        }
        
        .vibes-label-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            font-weight: 600;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        
        .vibes-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            font-weight: 600;
            text-shadow: 0 1px 3px rgba(0,0,0,0.5);
        }
        
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(6, 95, 70, 0.95);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            margin-top: 4px;
            z-index: 50;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .dropdown-item {
            padding: 12px 16px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        @keyframes spinGlobe {
            from { transform: rotateZ(0deg); }
            to { transform: rotateZ(360deg); }
        }
        
        /* Stelle Hotel */
        .stars-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
        }
        
        .stars-selector {
            display: flex;
            gap: 5px;
        }
        
        .star {
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            opacity: 0.3;
            filter: grayscale(1);
        }
        
        .star.active {
            opacity: 1;
            filter: grayscale(0);
            transform: scale(1.1);
        }
        
        .star:hover {
            transform: scale(1.2);
        }
        
        .stars-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            font-weight: 500;
        }
        
        .hidden { display: none; }
    </style>
</head>
<body class="text-white">
    <!-- STEP 1: FORM -->
    <div id="form-step">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center mb-8">
                <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                    Gloober
                </h1>
                <p class="text-xl text-gray-300">Zero stress, book happiness! ‚úàÔ∏è</p>
            </div>

            <div class="max-w-2xl mx-auto">
                <div class="glass-card rounded-2xl p-6">
                    <!-- Budget -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">üí∞ Budget totale</label>
                        <div class="grid grid-cols-3 gap-3">
                            <input type="number" id="budget" value="1000" min="100" max="10000" step="100" 
                                   class="col-span-2 px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white text-xl font-bold">
                            <select id="currency" class="px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white">
                                <option value="EUR">‚Ç¨ EUR</option>
                                <option value="GBP">¬£ GBP</option>
                                <option value="CHF">CHF</option>
                                <option value="DKK">DKK</option>
                                <option value="SEK">SEK</option>
                                <option value="NOK">NOK</option>
                                <option value="CZK">CZK</option>
                                <option value="PLN">PLN</option>
                                <option value="HUF">HUF</option>
                            </select>
                        </div>
                    </div>

                    <!-- Persone -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">üë• Quante persone</label>
                        <select id="people" class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white">
                            <option value="1">1 persona</option>
                            <option value="2" selected>2 persone</option>
                            <option value="3">3 persone</option>
                            <option value="4">4 persone</option>
                        </select>
                    </div>

                    <!-- Quando -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">üìÖ Quando partiamo</label>
                        <div class="relative">
                            <button type="button" onclick="toggleDateMenu()" 
                                    class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white flex justify-between items-center">
                                <span id="when-selected">OGGI</span>
                                <span>‚ñº</span>
                            </button>
                            <div id="date-menu" class="dropdown-menu hidden"></div>
                        </div>
                    </div>

                    <!-- Durata -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">‚è±Ô∏è Per quanto tempo</label>
                        <div class="relative">
                            <button type="button" onclick="toggleDurationMenu()" 
                                    class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white flex justify-between items-center">
                                <span id="duration-selected">Due giorni</span>
                                <span>‚ñº</span>
                            </button>
                            <div id="duration-menu" class="dropdown-menu hidden"></div>
                        </div>
                    </div>
                    
                    <!-- Stelle Hotel -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">üè® Categoria hotel</label>
                        <div class="stars-container">
                            <div class="stars-selector" id="stars-selector">
                                <span class="star" data-stars="1" onclick="selectStars(1)">‚≠ê</span>
                                <span class="star" data-stars="2" onclick="selectStars(2)">‚≠ê</span>
                                <span class="star" data-stars="3" onclick="selectStars(3)">‚≠ê</span>
                                <span class="star" data-stars="4" onclick="selectStars(4)">‚≠ê</span>
                                <span class="star" data-stars="5" onclick="selectStars(5)">‚≠ê</span>
                            </div>
                            <span class="stars-label" id="stars-label">3 stelle</span>
                        </div>
                    </div>

                    <!-- Citt√† partenza - NASCOSTO, si mostra dopo -->
                    <div class="mb-6 hidden" id="departure-section">
                        <label class="block text-sm font-medium mb-2">‚úàÔ∏è Da quale citt√† parti</label>
                        <select id="departure" class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white">
                            <option value="MXP">Milano Malpensa</option>
                            <option value="LIN">Milano Linate</option>
                            <option value="BGY">Milano Bergamo</option>
                            <option value="FCO">Roma Fiumicino</option>
                            <option value="VCE">Venezia</option>
                            <option value="NAP">Napoli</option>
                        </select>
                    </div>

                    <!-- Vibes Slider NUOVO -->
                    <div class="mb-8">
                        <label class="block text-sm font-medium mb-4 text-center">‚ú® Travel vibes</label>
                        <div class="vibes-slider-horizontal" id="vibes-slider" onclick="moveVibesDot(event)" ontouchmove="moveVibesDot(event)" ontouchstart="moveVibesDot(event)">
                            <div class="slider-inner-labels">
                                <span>üèñÔ∏è MARE</span>
                                <span class="label-center hidden">üé® CITT√Ä D'ARTE</span>
                                <span>üèîÔ∏è MONTAGNA</span>
                            </div>
                            <div class="vibes-dot" id="vibes-dot" onclick="handleGlobeClick(event)">
                                <span class="gloob-text">JUST GLOOB IT</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- STEP 1.5: SELEZIONE AEROPORTO -->
    <div id="airport-step" class="hidden">
        <div class="container mx-auto px-4 py-8">
            <div class="text-center mb-8">
                <div style="font-size: 80px; margin-bottom: 20px;">‚úàÔ∏è</div>
                <h2 class="text-3xl font-bold mb-4 text-white">
                    Da dove decolliamo?
                </h2>
            </div>

            <div class="max-w-2xl mx-auto">
                <div class="glass-card rounded-2xl p-6">
                    <div class="mb-6">
                        <input type="text" 
                               id="airport-search" 
                               placeholder="Cerca il tuo aeroporto..." 
                               class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50"
                               onkeyup="filterAirports()">
                    </div>
                    
                    <div class="mb-6">
                        <select id="airport-select" size="10" 
                                class="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white"
                                style="min-height: 300px;">
                            <optgroup label="Italia">
                                <option value="MXP">Milano Malpensa</option>
                                <option value="LIN">Milano Linate</option>
                                <option value="BGY">Milano Bergamo</option>
                                <option value="FCO">Roma Fiumicino</option>
                                <option value="CIA">Roma Ciampino</option>
                                <option value="VCE">Venezia Marco Polo</option>
                                <option value="TSF">Venezia Treviso</option>
                                <option value="NAP">Napoli</option>
                                <option value="BLQ">Bologna</option>
                                <option value="FLR">Firenze</option>
                                <option value="TRN">Torino</option>
                                <option value="CTA">Catania</option>
                                <option value="PMO">Palermo</option>
                                <option value="BRI">Bari</option>
                                <option value="VRN">Verona</option>
                            </optgroup>
                            <optgroup label="Francia">
                                <option value="CDG">Parigi Charles de Gaulle</option>
                                <option value="ORY">Parigi Orly</option>
                                <option value="NCE">Nizza</option>
                                <option value="LYS">Lione</option>
                                <option value="MRS">Marsiglia</option>
                            </optgroup>
                            <optgroup label="Germania">
                                <option value="FRA">Francoforte</option>
                                <option value="MUC">Monaco</option>
                                <option value="BER">Berlino</option>
                                <option value="HAM">Amburgo</option>
                                <option value="DUS">D√ºsseldorf</option>
                                <option value="CGN">Colonia</option>
                                <option value="STR">Stoccarda</option>
                            </optgroup>
                            <optgroup label="Spagna">
                                <option value="MAD">Madrid</option>
                                <option value="BCN">Barcellona</option>
                                <option value="VLC">Valencia</option>
                                <option value="AGP">Malaga</option>
                                <option value="PMI">Palma di Maiorca</option>
                                <option value="SVQ">Siviglia</option>
                                <option value="BIO">Bilbao</option>
                            </optgroup>
                            <optgroup label="Regno Unito">
                                <option value="LHR">Londra Heathrow</option>
                                <option value="LGW">Londra Gatwick</option>
                                <option value="STN">Londra Stansted</option>
                                <option value="LTN">Londra Luton</option>
                                <option value="MAN">Manchester</option>
                                <option value="EDI">Edimburgo</option>
                                <option value="BHX">Birmingham</option>
                            </optgroup>
                            <optgroup label="Altri">
                                <option value="AMS">Amsterdam</option>
                                <option value="ZRH">Zurigo</option>
                                <option value="GVA">Ginevra</option>
                                <option value="VIE">Vienna</option>
                                <option value="PRG">Praga</option>
                                <option value="BRU">Bruxelles</option>
                                <option value="CPH">Copenhagen</option>
                                <option value="STO">Stoccolma</option>
                                <option value="OSL">Oslo</option>
                                <option value="HEL">Helsinki</option>
                                <option value="DUB">Dublino</option>
                                <option value="LIS">Lisbona</option>
                                <option value="OPO">Porto</option>
                                <option value="ATH">Atene</option>
                                <option value="WAW">Varsavia</option>
                                <option value="BUD">Budapest</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <button onclick="confirmAirport()" 
                            class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-300 hover:to-orange-400 transition-all">
                        Voliamo! üõ´
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div id="loading-step" class="hidden min-h-screen flex items-center justify-center">
        <div class="text-center">
            <div style="width: 300px; height: 300px; margin: 0 auto;">
                <div style="animation: spinGlobe 3s linear infinite;">
                    <div style="width: 250px; height: 250px; margin: 0 auto; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #60a5fa, #3b82f6, #2563eb, #1e40af); box-shadow: inset -40px -40px 60px rgba(0, 0, 0, 0.4), 0 0 60px rgba(59, 130, 246, 0.6); position: relative;">
                        <!-- Continenti -->
                        <div style="position: absolute; background: radial-gradient(ellipse, #10b981, #059669); width: 50px; height: 40px; top: 15%; left: 48%; border-radius: 50%; transform: rotate(-15deg);"></div>
                        <div style="position: absolute; background: radial-gradient(ellipse, #10b981, #059669); width: 60px; height: 80px; top: 45%; left: 47%; border-radius: 50%;"></div>
                        <div style="position: absolute; background: radial-gradient(ellipse, #10b981, #059669); width: 70px; height: 50px; top: 20%; right: 15%; border-radius: 50%;"></div>
                    </div>
                </div>
            </div>
            <h2 class="text-3xl font-bold mt-4">Gloobing...</h2>
            <p class="text-gray-300 mt-2" id="loading-text">Sto trovando la tua prossima avventura</p>
        </div>
    </div>

    <!-- STEP 3: RISULTATI -->
    <div id="result-step" class="hidden container mx-auto px-4 py-8">
        <div id="result-content" class="max-w-6xl mx-auto">
            <!-- Header con descrizione AI -->
            <div class="glass-card rounded-2xl p-6 text-center mb-6">
                <h2 class="text-3xl font-bold text-yellow-400 mb-3" id="destination-name">Caricamento...</h2>
                <p class="text-xl text-white italic" id="ai-description">L'AI sta creando la tua esperienza perfetta...</p>
            </div>
            
            <!-- Cards Volo e Hotel -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- Card Volo -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">‚úàÔ∏è Il tuo volo</h3>
                    <div id="flight-details" class="text-white">
                        <div class="mb-3">
                            <span class="text-gray-400">Andata:</span>
                            <div class="font-semibold" id="flight-outbound">-</div>
                        </div>
                        <div class="mb-3">
                            <span class="text-gray-400">Ritorno:</span>
                            <div class="font-semibold" id="flight-return">-</div>
                        </div>
                        <div class="mb-4">
                            <span class="text-gray-400">Compagnia:</span>
                            <div class="font-semibold" id="flight-airline">-</div>
                        </div>
                        <div class="text-2xl font-bold text-yellow-400 mb-4" id="flight-price">-</div>
                        <button class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-300 hover:to-orange-400 transition-all" id="book-flight">
                            Prenota Volo ‚Üí
                        </button>
                    </div>
                </div>
                
                <!-- Card Hotel -->
                <div class="glass-card rounded-2xl p-6">
                    <h3 class="text-xl font-bold mb-4 text-yellow-400">üè® Il tuo hotel</h3>
                    <div id="hotel-details" class="text-white">
                        <div class="mb-3">
                            <div class="font-semibold text-lg" id="hotel-name">-</div>
                            <div class="text-yellow-400" id="hotel-stars">-</div>
                        </div>
                        <div class="mb-3">
                            <span class="text-gray-400">Valutazione:</span>
                            <div class="font-semibold" id="hotel-rating">-</div>
                        </div>
                        <div class="mb-3">
                            <span class="text-gray-400">Tipo camera:</span>
                            <div class="font-semibold" id="hotel-room">-</div>
                        </div>
                        <div class="text-2xl font-bold text-yellow-400 mb-4" id="hotel-price">-</div>
                        <button class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-bold py-3 px-6 rounded-xl hover:from-yellow-300 hover:to-orange-400 transition-all" id="book-hotel">
                            Prenota Hotel ‚Üí
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Totale -->
            <div class="glass-card rounded-2xl p-6 text-center mb-6">
                <h3 class="text-2xl font-bold text-white mb-2">üí∞ Totale per <span id="total-people">2</span> persone</h3>
                <div class="text-4xl font-bold text-yellow-400" id="total-price">-</div>
            </div>
            
            <!-- Citazione -->
            <div class="glass-card rounded-2xl p-6 text-center">
                <p class="text-lg text-white italic mb-2" id="quote-text">"..."</p>
                <p class="text-gray-400" id="quote-author">- ...</p>
            </div>
            
            <!-- Bottone Nuova Ricerca -->
            <div class="text-center mt-8">
                <button onclick="location.reload()" 
                        class="bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-bold py-3 px-6 rounded-xl">
                    üé≤ Re-Gloob!
                </button>
            </div>
        </div>
    </div>

    <script>
        // STATO GLOBALE SEMPLICE
        let selectedDate = new Date();
        let vibePosition = 50; // 0 = montagna, 100 = mare
        let isDragging = false;
        let clickTimer = null;
        let selectedDuration = 2;
        let userLocation = null;
        let selectedAirport = null;
        let hasMovedSlider = false; // Per tracciare se lo slider √® stato mosso
        let selectedStars = 3; // Default 3 stelle
        
        // DATABASE 50 DESTINAZIONI GLOOBER
        const destinations = [
            // MARE 0-10% - Classiche e famose
            {
                position: 0,
                name: 'Santorini',
                country: 'Grecia',
                tagline: 'Il sogno greco',
                description: 'Tramonti che il mondo ci invidia, case bianche e cupole blu che si specchiano nell\'Egeo.',
                category: 'mare-classico',
                searchTerm: 'Santorini,+Greece',
                image: 'santorini.jpg',
                priceIndex: 4, // 1-5 quanto costa
                bestMonths: [5,6,7,8,9],
                quote: '"In nessun altro luogo il tramonto ha lo stesso sapore" - Odysseas Elytis'
            },
            {
                position: 5,
                name: 'Mykonos',
                country: 'Grecia', 
                tagline: 'L\'isola che non dorme mai',
                description: 'Mulini a vento, vicoli bianchi e una nightlife leggendaria nel cuore delle Cicladi.',
                category: 'mare-vitanotturna',
                searchTerm: 'Mykonos,+Greece',
                priceIndex: 5,
                bestMonths: [6,7,8,9],
                quote: '"Mykonos √® uno stato mentale" - Giorgio Armani'
            },
            
            // MARE 10-20% - Vita notturna
            {
                position: 10,
                name: 'Ibiza',
                country: 'Spagna',
                tagline: 'L\'isola della libert√†',
                description: 'Dove il tramonto diventa party e le calette nascondono segreti hippy.',
                category: 'mare-vitanotturna',
                searchTerm: 'Ibiza,+Spain',
                priceIndex: 4,
                bestMonths: [5,6,7,8,9],
                quote: '"Ibiza √® pi√π di un\'isola, √® un\'esperienza" - Carl Cox'
            },
            {
                position: 15,
                name: 'Hvar',
                country: 'Croazia',
                tagline: 'La Saint-Tropez dell\'Adriatico',
                description: 'Lavanda, yacht e locali esclusivi in un\'isola dalmata dal fascino veneziano.',
                category: 'mare-vitale',
                searchTerm: 'Hvar,+Croatia',
                priceIndex: 3,
                bestMonths: [6,7,8,9],
                quote: '"Il paradiso esiste e parla croato" - George Bernard Shaw'
            },
            
            // MARE 20-30% - Vitale/Relax
            {
                position: 20,
                name: 'Taghazout',
                country: 'Marocco',
                tagline: 'Il paradiso dei surfisti',
                description: 'Onde perfette, villaggi berberi e tramonti sull\'Atlantico africano.',
                category: 'mare-sport',
                searchTerm: 'Taghazout,+Morocco',
                priceIndex: 2,
                bestMonths: [1,2,3,10,11,12],
                quote: '"Il surf √® la poesia del mare" - Proverbio marocchino'
            },
            {
                position: 25,
                name: 'Comporta',
                country: 'Portogallo',
                tagline: 'Gli Hamptons d\'Europa',
                description: 'Risaie, cicogne e spiagge infinite dove il jet set cerca l\'understatement.',
                category: 'mare-relax',
                searchTerm: 'Comporta,+Portugal',
                priceIndex: 4,
                bestMonths: [5,6,7,8,9,10],
                quote: '"La semplicit√† √® il massimo della sofisticazione" - Leonardo da Vinci'
            },
            
            // MARE 30-40% - Romantiche nascoste
            {
                position: 30,
                name: 'Paros',
                country: 'Grecia',
                tagline: 'La Grecia autentica',
                description: 'L\'isola dove i greci vanno in vacanza, lontano dalle folle ma vicino al paradiso.',
                category: 'mare-romantico',
                searchTerm: 'Paros,+Greece',
                priceIndex: 3,
                bestMonths: [5,6,7,8,9],
                quote: '"La bellezza salver√† il mondo" - Dostoevskij'
            },
            {
                position: 35,
                name: 'Isola di Holbox',
                country: 'Messico',
                tagline: 'Caraibi senza filtri',
                description: 'Niente auto, tanto plancton luminescente e fenicotteri rosa in un paradiso segreto.',
                category: 'mare-nascosto',
                searchTerm: 'Holbox,+Mexico',
                priceIndex: 2,
                bestMonths: [1,2,3,4,11,12],
                quote: '"Il vero viaggio √® quello che non lascia tracce" - Lao Tzu'
            },
            
            // MARE 40-50% - Avventura
            {
                position: 40,
                name: 'Faroe Islands',
                country: 'Danimarca',
                tagline: 'Il segreto del Nord Atlantico',
                description: 'Cascate che cadono nell\'oceano, pecore ovunque e una natura che toglie il fiato.',
                category: 'mare-avventura',
                searchTerm: 'Faroe+Islands',
                priceIndex: 3,
                bestMonths: [6,7,8],
                quote: '"La natura selvaggia √® una necessit√†" - John Muir'
            },
            {
                position: 45,
                name: 'Lofoten',
                country: 'Norvegia',
                tagline: 'Dove l\'Artico incontra il mare',
                description: 'Villaggi di pescatori rossi, aurora boreale e il sole di mezzanotte tra i fiordi.',
                category: 'mare-estremo',
                searchTerm: 'Lofoten,+Norway',
                priceIndex: 4,
                bestMonths: [6,7,8,9],
                quote: '"Il Nord √® uno stato dell\'anima" - Fridtjof Nansen'
            },
            
            // CENTRO 50% - Arte famose
            {
                position: 50,
                name: 'Roma',
                country: 'Italia',
                tagline: 'La Citt√† Eterna',
                description: 'Dove ogni angolo √® un museo e la storia si respira tra carbonara e Colosseo.',
                category: 'arte-iconica',
                searchTerm: 'Rome,+Italy',
                priceIndex: 3,
                bestMonths: [3,4,5,9,10,11],
                quote: '"Roma √® la capitale del mondo" - Goethe'
            },
            {
                position: 50,
                name: 'Parigi',
                country: 'Francia',
                tagline: 'La Ville Lumi√®re',
                description: 'Torre Eiffel, croissant e l\'arte di vivere francese in ogni boulevard.',
                category: 'arte-iconica',
                searchTerm: 'Paris,+France',
                priceIndex: 4,
                bestMonths: [4,5,6,9,10],
                quote: '"Parigi √® sempre una buona idea" - Audrey Hepburn'
            },
            {
                position: 50,
                name: 'Firenze',
                country: 'Italia',
                tagline: 'La culla del Rinascimento',
                description: 'Michelangelo, Botticelli e bistecca alla fiorentina in un museo a cielo aperto.',
                category: 'arte-iconica',
                searchTerm: 'Florence,+Italy',
                priceIndex: 3,
                bestMonths: [4,5,6,9,10],
                quote: '"Ogni blocco di pietra ha una statua dentro" - Michelangelo'
            },
            
            // ARTE 45-55% - Romantiche meno note
            {
                position: 45,
                name: 'Bruges',
                country: 'Belgio',
                tagline: 'La Venezia del Nord',
                description: 'Canali medievali, cioccolato e merletti in una fiaba di mattoni.',
                category: 'arte-romantica',
                searchTerm: 'Bruges,+Belgium',
                priceIndex: 3,
                bestMonths: [4,5,6,7,8,9],
                quote: '"Bruges √® un sogno" - Georges Rodenbach'
            },
            {
                position: 55,
                name: 'ƒåesk√Ω Krumlov',
                country: 'Repubblica Ceca',
                tagline: 'La perla della Boemia',
                description: 'Un castello da fiaba, il fiume che abbraccia la citt√† e birra a fiumi.',
                category: 'arte-romantica',
                searchTerm: 'Cesky+Krumlov,+Czech+Republic',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Le fiabe esistono, basta sapere dove cercarle" - Proverbio ceco'
            },
            
            // ARTE 40-60% - Da scoprire
            {
                position: 40,
                name: 'Matera',
                country: 'Italia',
                tagline: 'La citt√† nella roccia',
                description: 'Sassi millenari dove il tempo si √® fermato e la storia vive nella pietra.',
                category: 'arte-nascosta',
                searchTerm: 'Matera,+Italy',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10],
                quote: '"Matera √® la citt√† pi√π singolare d\'Italia" - Carlo Levi'
            },
            {
                position: 60,
                name: 'Guimar√£es',
                country: 'Portogallo',
                tagline: 'Qui √® nato il Portogallo',
                description: 'Castello medievale, azulejos e la culla della nazione portoghese.',
                category: 'arte-nascosta',
                searchTerm: 'Guimaraes,+Portugal',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10],
                quote: '"Il Portogallo non √® un paese piccolo" - Salazar'
            },
            
            // ARTE-MARE 30-40% - Mix cultura e costa
            {
                position: 35,
                name: 'Essaouira',
                country: 'Marocco',
                tagline: 'La perla dell\'Atlantico',
                description: 'Medina bianca e blu dove Hendrix suonava e il vento non smette mai.',
                category: 'mare-cultura',
                searchTerm: 'Essaouira,+Morocco',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10,11],
                quote: '"Il vento di Essaouira porta via i pensieri" - Jimi Hendrix'
            },
            {
                position: 35,
                name: 'Kotor',
                country: 'Montenegro',
                tagline: 'Il fiordo del Mediterraneo',
                description: 'Mura veneziane che scalano montagne e si specchiano in una baia da sogno.',
                category: 'mare-cultura',
                searchTerm: 'Kotor,+Montenegro',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Montenegro, il gioiello nascosto dei Balcani" - Lord Byron'
            },
            
            // MONTAGNA 55-65% - Arte montana
            {
                position: 60,
                name: 'Innsbruck',
                country: 'Austria',
                tagline: 'La capitale delle Alpi',
                description: 'Cristalli Swarovski, tetti d\'oro e piste da sci a 20 minuti dal centro.',
                category: 'montagna-cultura',
                searchTerm: 'Innsbruck,+Austria',
                priceIndex: 3,
                bestMonths: [1,2,3,6,7,8,12],
                quote: '"Le montagne sono le grandi cattedrali della terra" - John Ruskin'
            },
            {
                position: 65,
                name: 'Annecy',
                country: 'Francia',
                tagline: 'La Venezia delle Alpi',
                description: 'Lago cristallino, canali fioriti e montagne che abbracciano la ville.',
                category: 'montagna-romantica',
                searchTerm: 'Annecy,+France',
                priceIndex: 3,
                bestMonths: [5,6,7,8,9],
                quote: '"La purezza del lago riflette l\'anima" - Rousseau'
            },
            
            // MONTAGNA 65-75% - Relax e benessere
            {
                position: 70,
                name: 'Bled',
                country: 'Slovenia',
                tagline: 'Il lago delle fiabe',
                description: 'Un\'isola con chiesa, un castello sulla roccia e le Alpi Giulie a corona.',
                category: 'montagna-relax',
                searchTerm: 'Bled,+Slovenia',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Bled √® poesia pura" - Agatha Christie'
            },
            {
                position: 75,
                name: 'Hallstatt',
                country: 'Austria',
                tagline: 'La cartolina perfetta',
                description: 'Il villaggio pi√π fotografato d\'Austria tra lago alpino e miniere di sale.',
                category: 'montagna-romantica',
                searchTerm: 'Hallstatt,+Austria',
                priceIndex: 3,
                bestMonths: [5,6,7,8,9],
                quote: '"La bellezza di Hallstatt √® quasi irreale" - Alexander von Humboldt'
            },
            
            // MONTAGNA 75-85% - Sport e avventura
            {
                position: 80,
                name: 'Chamonix',
                country: 'Francia',
                tagline: 'La capitale mondiale dell\'alpinismo',
                description: 'Ai piedi del Monte Bianco, dove nascono le leggende della montagna.',
                category: 'montagna-sport',
                searchTerm: 'Chamonix,+France',
                priceIndex: 4,
                bestMonths: [1,2,3,6,7,8,12],
                quote: '"Le montagne non sono stadi dove soddisfo la mia ambizione" - Anatoli Boukreev'
            },
            {
                position: 85,
                name: 'Interlaken',
                country: 'Svizzera',
                tagline: 'L\'adrenalina tra due laghi',
                description: 'Base jumping, parapendio e treni per Jungfrau nel cuore delle Alpi.',
                category: 'montagna-estrema',
                searchTerm: 'Interlaken,+Switzerland',
                priceIndex: 5,
                bestMonths: [1,2,3,6,7,8,12],
                quote: '"In montagna si trova la libert√†" - Friedrich Nietzsche'
            },
            
            // MONTAGNA 85-95% - Esclusive
            {
                position: 90,
                name: 'St. Moritz',
                country: 'Svizzera',
                tagline: 'Top of the World',
                description: 'Champagne climate, neve perfetta e il jet set mondiale dal 1864.',
                category: 'montagna-lusso',
                searchTerm: 'St+Moritz,+Switzerland',
                priceIndex: 5,
                bestMonths: [1,2,3,7,8,12],
                quote: '"St. Moritz non √® una destinazione, √® uno stile di vita" - Coco Chanel'
            },
            {
                position: 92,
                name: 'Aspen',
                country: 'USA',
                tagline: 'Il playground delle star',
                description: 'Quattro montagne, champagne powder e celebrities in ogni angolo.',
                category: 'montagna-lusso',
                searchTerm: 'Aspen,+Colorado',
                priceIndex: 5,
                bestMonths: [1,2,3,12],
                quote: '"Aspen √® dove la neve incontra le stelle" - John Denver'
            },
            
            // MONTAGNA 95-100% - Classiche
            {
                position: 95,
                name: 'Zermatt',
                country: 'Svizzera',
                tagline: 'All\'ombra del Cervino',
                description: 'La montagna perfetta, il villaggio senza auto e fonduta con vista.',
                category: 'montagna-classica',
                searchTerm: 'Zermatt,+Switzerland',
                priceIndex: 5,
                bestMonths: [1,2,3,7,8,12],
                quote: '"Il Cervino non si conquista, ti permette di salire" - Edward Whymper'
            },
            {
                position: 100,
                name: 'Cortina',
                country: 'Italia',
                tagline: 'La Regina delle Dolomiti',
                description: 'Glamour italiano, Aperol Spritz e le Tofane rosa al tramonto.',
                category: 'montagna-classica',
                searchTerm: 'Cortina+d\'Ampezzo,+Italy',
                priceIndex: 4,
                bestMonths: [1,2,3,7,8,12],
                quote: '"Cortina √® un\'emozione vestita di neve" - Alberto Tomba'
            },
            
            // EXTRA - Destinazioni alternative distribuite
            {
                position: 15,
                name: 'Gili Islands',
                country: 'Indonesia',
                tagline: 'No cars, no stress',
                description: 'Tre isole dove le tartarughe sono di casa e la vita scorre in bicicletta.',
                category: 'mare-alternativo',
                searchTerm: 'Gili+Islands,+Indonesia',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"La semplicit√† √® la vera ricchezza" - Proverbio indonesiano'
            },
            {
                position: 25,
                name: 'S√®te',
                country: 'Francia',
                tagline: 'La Venezia del Languedoc',
                description: 'Porto di pescatori, canali e ostriche dove il Mediterraneo √® ancora autentico.',
                category: 'mare-autentico',
                searchTerm: 'Sete,+France',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Il mare √® tutto" - Georges Brassens'
            },
            {
                position: 45,
                name: 'Ljubljana',
                country: 'Slovenia',
                tagline: 'Il segreto verde d\'Europa',
                description: 'Draghi, castello e una capitale a misura d\'uomo dove i caff√® sono salotti.',
                category: 'arte-emergente',
                searchTerm: 'Ljubljana,+Slovenia',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Ljubljana √® amore a prima vista" - Le Corbusier'
            },
            {
                position: 55,
                name: 'Ghent',
                country: 'Belgio',
                tagline: 'Il segreto meglio custodito',
                description: 'Pi√π bella di Bruges ma senza le folle, con birre trappiste e arte fiamminga.',
                category: 'arte-alternativa',
                searchTerm: 'Ghent,+Belgium',
                priceIndex: 2,
                bestMonths: [4,5,6,7,8,9],
                quote: '"Gent √® la citt√† del futuro" - Carlo V'
            },
            {
                position: 65,
                name: 'Zakopane',
                country: 'Polonia',
                tagline: 'La capitale invernale polacca',
                description: 'Architettura in legno, formaggi affumicati e i Monti Tatra a portata di funivia.',
                category: 'montagna-autentica',
                searchTerm: 'Zakopane,+Poland',
                priceIndex: 2,
                bestMonths: [1,2,3,7,8,12],
                quote: '"Le montagne sono la libert√† della Polonia" - Papa Giovanni Paolo II'
            },
            {
                position: 75,
                name: 'Dolomiti di Brenta',
                country: 'Italia',
                tagline: 'Le Dolomiti segrete',
                description: 'Vie ferrate, rifugi con polenta e il lago di Molveno come specchio.',
                category: 'montagna-alternativa',
                searchTerm: 'Madonna+di+Campiglio,+Italy',
                priceIndex: 3,
                bestMonths: [1,2,3,6,7,8,12],
                quote: '"Le Dolomiti sono i monti pallidi che diventano rosa" - Dino Buzzati'
            },
            {
                position: 20,
                name: 'Porto Santo',
                country: 'Portogallo',
                tagline: 'L\'isola dorata',
                description: '9 km di spiaggia dorata, acque terapeutiche e la pace di Madeira senza le folle.',
                category: 'mare-relax',
                searchTerm: 'Porto+Santo,+Madeira',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9,10],
                quote: '"Porto Santo √® dove Colombo sognava le Americhe" - Jos√© Saramago'
            },
            {
                position: 42,
                name: 'Tallinn',
                country: 'Estonia',
                tagline: 'Il Medioevo digitale',
                description: 'Torri medievali e startup, dove il passato incontra il futuro baltico.',
                category: 'arte-tech',
                searchTerm: 'Tallinn,+Estonia',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"Tallinn √® dove il digitale ha radici medievali" - Toomas Hendrik'
            },
            {
                position: 58,
                name: 'Ronda',
                country: 'Spagna',
                tagline: 'La citt√† sul precipizio',
                description: 'Il ponte che sfida la gravit√†, toreri leggendari e tapas con vista.',
                category: 'arte-drammatica',
                searchTerm: 'Ronda,+Spain',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10],
                quote: '"Ronda √® un sogno sospeso nel vuoto" - Hemingway'
            },
            {
                position: 72,
                name: 'Val di Funes',
                country: 'Italia',
                tagline: 'La valle delle Odle',
                description: 'La chiesetta pi√π fotografata, masi tirolesi e le Dolomiti come corona.',
                category: 'montagna-instagram',
                searchTerm: 'Val+di+Funes,+Italy',
                priceIndex: 3,
                bestMonths: [6,7,8,9,10],
                quote: '"Le Odle sono le dita di Dio" - Reinhold Messner'
            },
            {
                position: 88,
                name: 'Verbier',
                country: 'Svizzera',
                tagline: 'Il sole delle Alpi',
                description: '400 km di piste, sole garantito e apr√®s-ski leggendario.',
                category: 'montagna-party',
                searchTerm: 'Verbier,+Switzerland',
                priceIndex: 5,
                bestMonths: [1,2,3,12],
                quote: '"Verbier √® dove la montagna diventa lifestyle" - James Blunt'
            },
            {
                position: 12,
                name: 'Naxos',
                country: 'Grecia',
                tagline: 'L\'isola degli dei',
                description: 'Spiagge infinite, Portara al tramonto e villaggi dove il tempo si √® fermato.',
                category: 'mare-autentico',
                searchTerm: 'Naxos,+Greece',
                priceIndex: 2,
                bestMonths: [5,6,7,8,9],
                quote: '"A Naxos Dioniso trov√≤ Arianna" - Mitologia greca'
            },
            {
                position: 48,
                name: 'Lucca',
                country: 'Italia',
                tagline: 'La citt√† delle 100 chiese',
                description: 'Mura rinascimentali da passeggiare in bici e Puccini in ogni piazza.',
                category: 'arte-musica',
                searchTerm: 'Lucca,+Italy',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10],
                quote: '"Lucca √® una citt√† da ascoltare" - Giacomo Puccini'
            },
            {
                position: 62,
                name: 'Sintra',
                country: 'Portogallo',
                tagline: 'Il giardino dei palazzi',
                description: 'Palazzi da fiaba, giardini misteriosi e la nebbia atlantica che tutto avvolge.',
                category: 'arte-fiabesca',
                searchTerm: 'Sintra,+Portugal',
                priceIndex: 2,
                bestMonths: [4,5,6,9,10],
                quote: '"Sintra √® il luogo dove la terra finisce e il mare comincia" - Cam√µes'
            },
            {
                position: 78,
                name: 'Courmayeur',
                country: 'Italia',
                tagline: 'Ai piedi del Monte Bianco',
                description: 'Eleganza alpina, terme con vista e il tetto d\'Europa a portata di funivia.',
                category: 'montagna-chic',
                searchTerm: 'Courmayeur,+Italy',
                priceIndex: 4,
                bestMonths: [1,2,3,7,8,12],
                quote: '"Il Monte Bianco √® il monarca delle montagne" - Byron'
            }
        ];
        
        // Mappa aeroporti -> valuta
        const airportCurrencies = {
            // Italia - EUR
            'MXP': 'EUR', 'LIN': 'EUR', 'BGY': 'EUR', 'FCO': 'EUR', 'CIA': 'EUR',
            'VCE': 'EUR', 'TSF': 'EUR', 'NAP': 'EUR', 'BLQ': 'EUR', 'FLR': 'EUR',
            'TRN': 'EUR', 'CTA': 'EUR', 'PMO': 'EUR', 'BRI': 'EUR', 'VRN': 'EUR',
            // Francia - EUR
            'CDG': 'EUR', 'ORY': 'EUR', 'NCE': 'EUR', 'LYS': 'EUR', 'MRS': 'EUR',
            // Germania - EUR
            'FRA': 'EUR', 'MUC': 'EUR', 'BER': 'EUR', 'HAM': 'EUR', 'DUS': 'EUR',
            'CGN': 'EUR', 'STR': 'EUR',
            // Spagna - EUR
            'MAD': 'EUR', 'BCN': 'EUR', 'VLC': 'EUR', 'AGP': 'EUR', 'PMI': 'EUR',
            'SVQ': 'EUR', 'BIO': 'EUR',
            // Altri EUR
            'AMS': 'EUR', 'VIE': 'EUR', 'BRU': 'EUR', 'HEL': 'EUR', 'ATH': 'EUR',
            'LIS': 'EUR', 'OPO': 'EUR', 'DUB': 'EUR',
            // Regno Unito - GBP
            'LHR': 'GBP', 'LGW': 'GBP', 'STN': 'GBP', 'LTN': 'GBP', 
            'MAN': 'GBP', 'EDI': 'GBP', 'BHX': 'GBP',
            // Svizzera - CHF
            'ZRH': 'CHF', 'GVA': 'CHF',
            // Altri
            'CPH': 'DKK', 'STO': 'SEK', 'OSL': 'NOK', 'PRG': 'CZK',
            'WAW': 'PLN', 'BUD': 'HUF'
        };

        // INIZIALIZZA DATE MENU
        function initDateMenu() {
            const menu = document.getElementById('date-menu');
            const monthNames = ['gen', 'feb', 'mar', 'apr', 'mag', 'giu', 'lug', 'ago', 'set', 'ott', 'nov', 'dic'];
            const dayNames = ['Dom', 'Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab'];
            
            // OGGI
            const oggi = document.createElement('div');
            oggi.className = 'dropdown-item';
            oggi.textContent = 'OGGI';
            oggi.onclick = () => selectDate(new Date(), 'OGGI');
            menu.appendChild(oggi);
            
            // Prossimi 30 giorni
            for (let i = 1; i < 30; i++) {
                const date = new Date();
                date.setDate(date.getDate() + i);
                
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = `${dayNames[date.getDay()]} ${date.getDate()} ${monthNames[date.getMonth()]}`;
                item.onclick = () => selectDate(date, item.textContent);
                menu.appendChild(item);
            }
        }
        
        // INIZIALIZZA DURATION MENU
        function initDurationMenu() {
            const menu = document.getElementById('duration-menu');
            const durations = [
                {value: 2, text: 'Due giorni'},
                {value: 3, text: 'Tre giorni'},
                {value: 4, text: 'Quattro giorni'},
                {value: 5, text: 'Cinque giorni'},
                {value: 7, text: 'Una settimana'},
                {value: 10, text: 'Dieci giorni'},
                {value: 14, text: 'Due settimane'}
            ];
            
            durations.forEach(dur => {
                const item = document.createElement('div');
                item.className = 'dropdown-item';
                item.textContent = dur.text;
                item.onclick = () => selectDuration(dur.value, dur.text);
                menu.appendChild(item);
            });
        }

        // TOGGLE DATE MENU
        function toggleDateMenu() {
            document.getElementById('date-menu').classList.toggle('hidden');
            document.getElementById('duration-menu').classList.add('hidden');
        }
        
        // TOGGLE DURATION MENU
        function toggleDurationMenu() {
            document.getElementById('duration-menu').classList.toggle('hidden');
            document.getElementById('date-menu').classList.add('hidden');
        }

        // SELECT DATE
        function selectDate(date, text) {
            selectedDate = date;
            document.getElementById('when-selected').textContent = text;
            document.getElementById('date-menu').classList.add('hidden');
        }
        
        // SELECT DURATION
        function selectDuration(value, text) {
            selectedDuration = value;
            document.getElementById('duration-selected').textContent = text;
            document.getElementById('duration-menu').classList.add('hidden');
        }
        
        // CHECK GEOLOCATION
        function checkGeolocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        // Trova aeroporto pi√π vicino basato su lat/lon
                        // Per ora simulo con Milano
                        userLocation = {
                            lat: position.coords.latitude,
                            lon: position.coords.longitude
                        };
                        selectedAirport = 'MXP'; // In produzione calcolerai quello pi√π vicino
                    },
                    (error) => {
                        console.log('Geolocalizzazione non disponibile');
                    }
                );
            }
        }
        
        // FILTER AIRPORTS
        function filterAirports() {
            const search = document.getElementById('airport-search').value.toLowerCase();
            const select = document.getElementById('airport-select');
            const options = select.getElementsByTagName('option');
            
            for (let option of options) {
                const text = option.textContent.toLowerCase();
                option.style.display = text.includes(search) ? '' : 'none';
            }
        }
        
        // CONFIRM AIRPORT
        function confirmAirport() {
            const select = document.getElementById('airport-select');
            if (select.value) {
                selectedAirport = select.value;
                
                // Imposta automaticamente la valuta
                const currency = airportCurrencies[selectedAirport] || 'EUR';
                document.getElementById('currency').value = currency;
                
                document.getElementById('airport-step').classList.add('hidden');
                document.getElementById('loading-step').classList.remove('hidden');
                
                setTimeout(() => {
                    showResults();
                }, 3000);
            } else {
                alert('Seleziona un aeroporto!');
            }
        }

        // MUOVI VIBES DOT - NUOVO per slider orizzontale
        function moveVibesDot(event) {
            event.preventDefault();
            event.stopPropagation();
            
            isDragging = true;
            const dot = document.getElementById('vibes-dot');
            dot.classList.add('dragging');
            dot.classList.remove('clickable');
            
            // Clear any existing timer
            if (clickTimer) {
                clearTimeout(clickTimer);
                clickTimer = null;
            }
            
            const slider = document.getElementById('vibes-slider');
            const rect = slider.getBoundingClientRect();
            
            let x;
            if (event.type.includes('touch')) {
                x = event.touches[0].clientX - rect.left;
            } else {
                x = event.clientX - rect.left;
            }
            
            const percentage = (x / rect.width) * 100;
            vibePosition = Math.max(0, Math.min(100, percentage));
            
            dot.style.left = vibePosition + '%';
            
            // Nascondi/mostra CITT√Ä D'ARTE in base alla posizione
            const centerLabel = document.querySelector('.label-center');
            
            // Se √® la prima volta che muovi lo slider
            if (!hasMovedSlider) {
                hasMovedSlider = true;
                // Mostra CITT√Ä D'ARTE solo se non sei nella zona centrale
                if (vibePosition < 35 || vibePosition > 65) {
                    centerLabel.classList.remove('hidden');
                }
            } else {
                // Dopo il primo movimento, mostra sempre CITT√Ä D'ARTE
                centerLabel.classList.remove('hidden');
            }
            
            // Start timer to make clickable after 1 second
            clickTimer = setTimeout(() => {
                isDragging = false;
                dot.classList.remove('dragging');
                dot.classList.add('clickable');
            }, 1000);
        }
        
        // GESTISCI CLICK SUL GLOBO
        function handleGlobeClick(event) {
            event.stopPropagation();
            if (!isDragging && document.getElementById('vibes-dot').classList.contains('clickable')) {
                startGloob();
            }
        }

        // START GLOOB
        async function startGloob() {
            const budget = parseInt(document.getElementById('budget').value);
            
            if (budget < 100) {
                alert('Budget minimo ‚Ç¨100');
                return;
            }
            
            // Se abbiamo gi√† la posizione, vai direttamente al loading
            if (selectedAirport) {
                document.getElementById('form-step').classList.add('hidden');
                document.getElementById('loading-step').classList.remove('hidden');
                
                setTimeout(() => {
                    showResults();
                }, 3000);
            } else {
                // Altrimenti mostra selezione aeroporto
                document.getElementById('form-step').classList.add('hidden');
                document.getElementById('airport-step').classList.remove('hidden');
            }
        }

        // MOSTRA RISULTATI
        async function showResults() {
            document.getElementById('loading-step').classList.add('hidden');
            document.getElementById('result-step').classList.remove('hidden');
            
            // Prepara i dati
            const budget = parseInt(document.getElementById('budget').value);
            const people = parseInt(document.getElementById('people').value);
            const currency = document.getElementById('currency').value;
            const currencySymbol = currency === 'EUR' ? '‚Ç¨' : currency === 'GBP' ? '¬£' : currency + ' ';
            
            // Trova destinazione basata sulla posizione dello slider
            const destination = getDestinationByPosition(vibePosition);
            
            // Simula prezzi hotel basati su stelle e price index
            const basePrice = [40, 60, 90, 150, 280][selectedStars - 1];
            const hotelPrice = Math.round(basePrice * (destination.priceIndex / 3));
            const hotelTotal = hotelPrice * selectedDuration;
            
            // Simula prezzo volo
            const flightPrice = Math.round(80 + (destination.priceIndex * 20) + (Math.random() * 40));
            const flightTotal = flightPrice * 2; // Andata e ritorno
            
            const total = hotelTotal + flightTotal;
            
            // Date
            const checkIn = new Date(selectedDate);
            const checkOut = new Date(selectedDate);
            checkOut.setDate(checkOut.getDate() + selectedDuration);
            
            // Aggiorna UI
            document.getElementById('destination-name').textContent = `${destination.name}, ${destination.country}`;
            document.getElementById('ai-description').textContent = destination.description;
            document.getElementById('total-people').textContent = people;
            
            // Hotel generico
            const hotelNames = ['Grand Hotel', 'Boutique Hotel', 'Hotel Central', 'Hotel Vista', 'Luxury Resort'];
            const hotelName = `${hotelNames[selectedStars-1]} ${destination.name}`;
            
            document.getElementById('hotel-name').textContent = hotelName;
            document.getElementById('hotel-stars').textContent = '‚≠ê'.repeat(selectedStars);
            document.getElementById('hotel-rating').textContent = `${8 + (selectedStars * 0.3)}/10`;
            document.getElementById('hotel-room').textContent = selectedStars <= 2 ? 'Camera standard' : selectedStars <= 4 ? 'Camera superior' : 'Suite';
            document.getElementById('hotel-price').textContent = `${currencySymbol}${hotelTotal}`;
            
            // Volo
            const airlines = ['Ryanair', 'EasyJet', 'Vueling', 'Wizz Air', 'ITA Airways', 'Lufthansa'];
            document.getElementById('flight-outbound').textContent = 
                `${selectedAirport} ‚Üí ${destination.name} | ${checkIn.toLocaleDateString('it-IT')} ore 08:30`;
            document.getElementById('flight-return').textContent = 
                `${destination.name} ‚Üí ${selectedAirport} | ${checkOut.toLocaleDateString('it-IT')} ore 18:45`;
            document.getElementById('flight-airline').textContent = airlines[Math.floor(Math.random() * airlines.length)];
            document.getElementById('flight-price').textContent = `${currencySymbol}${flightTotal}`;
            
            // Totale
            document.getElementById('total-price').textContent = `${currencySymbol}${total}`;
            
            // Citazione
            document.getElementById('quote-text').textContent = destination.quote.split(' - ')[0];
            document.getElementById('quote-author').textContent = '- ' + destination.quote.split(' - ')[1];
            
            // Mappa destinazioni ‚Üí codice aeroporto IATA (per Skyscanner)
function getClosestAirportCode(searchTerm) {
    const map = {
        'Santorini,+Greece': 'JTR',
        'Mykonos,+Greece': 'JMK',
        'Ibiza,+Spain': 'IBZ',
        'Hvar,+Croatia': 'SPU',
        'Rome,+Italy': 'ROM',
        'Paris,+France': 'PAR',
        'Florence,+Italy': 'FLR',
        'Bruges,+Belgium': 'BRU',
        'Cesky+Krumlov,+Czech+Republic': 'PRG',
        'Amsterdam,+Netherlands': 'AMS',
        'Madrid,+Spain': 'MAD',
        'Vienna,+Austria': 'VIE',
        'Zurich,+Switzerland': 'ZRH',
        'Lisbon,+Portugal': 'LIS',
        'Porto,+Portugal': 'OPO',
        'Athens,+Greece': 'ATH',
        'Barcelona,+Spain': 'BCN',
        'Budapest,+Hungary': 'BUD',
        'Napoli,+Italy': 'NAP'
        // puoi aggiungere altre destinazioni se vuoi
    };
    return map[searchTerm] || 'PAR'; // fallback a Parigi
}

// Link Trip.com diretto alla ricerca hotel con citt√†
document.getElementById('book-hotel').onclick = () => {
    const cityName = destination.name.toLowerCase().replace(/ /g, '-');
    window.open(`https://trip.tpk.lu/DCFSQxzu?url=https://it.trip.com/hotels/${cityName}-hotels/`, '_blank');
};

// ‚úÖ Skyscanner ‚Äì Voli
document.getElementById('book-flight').onclick = () => {
  window.open(`https://www.skyscanner.it`, '_blank');
};
        }
        
        // NUOVA FUNZIONE: Trova destinazione per posizione
        function getDestinationByPosition(position) {
            // Trova destinazioni vicine alla posizione (¬±5%)
            let nearbyDestinations = destinations.filter(d => 
                Math.abs(d.position - position) <= 5
            );
            
            // Se non ci sono destinazioni vicine, prendi la pi√π vicina
            if (nearbyDestinations.length === 0) {
                nearbyDestinations = destinations.sort((a, b) => 
                    Math.abs(a.position - position) - Math.abs(b.position - position)
                ).slice(0, 3);
            }
            
            // Scegli random tra le vicine per variet√†
            return nearbyDestinations[Math.floor(Math.random() * nearbyDestinations.length)];
        }

        // SELECT STARS
        function selectStars(stars) {
            selectedStars = stars;
            const starElements = document.querySelectorAll('.star');
            
            starElements.forEach((star, index) => {
                if (index < stars) {
                    star.classList.add('active');
                } else {
                    star.classList.remove('active');
                }
            });
            
            const labels = ['1 stella', '2 stelle', '3 stelle', '4 stelle', '5 stelle'];
            document.getElementById('stars-label').textContent = labels[stars - 1];
        }
        
        // INIT AL CARICAMENTO
        window.onload = function() {
            initDateMenu();
            initDurationMenu();
            checkGeolocation();
            
            // Inizializza stelle a 3
            selectStars(3);
            
            // Make globe clickable initially
            setTimeout(() => {
                document.getElementById('vibes-dot').classList.add('clickable');
            }, 500);
            
            // Chiudi menu quando clicchi fuori
            document.onclick = function(e) {
                if (!e.target.closest('.relative')) {
                    document.getElementById('date-menu').classList.add('hidden');
                    document.getElementById('duration-menu').classList.add('hidden');
                }
            };
        };
    </script>
</body>
</html>
